<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatsMaster - UE27 Pr. Balay√©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card { transition: all 0.3s; }
        .card:hover { transform: translateY(-5px); }
        .hidden { display: none; }
        .correct { background-color: #d1fae5; border-color: #10b981; }
        .wrong { background-color: #fee2e2; border-color: #ef4444; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen font-sans">

    <nav class="bg-indigo-700 text-white p-4 shadow-xl sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold flex items-center gap-2">üìä UE27 <span class="hidden md:inline">Stats & √âpid√©mio</span></h1>
            <div class="flex gap-4 text-sm font-medium">
                <button onclick="showSection('home')" class="hover:text-indigo-200">Accueil</button>
                <button onclick="showSection('stats')" class="hover:text-indigo-200">Suivi</button>
                <button onclick="showSection('quiz')" class="bg-white text-indigo-700 px-3 py-1 rounded-full">S'entra√Æner</button>
            </div>
        </div>
    </nav>

    <section id="home" class="container mx-auto p-6">
        <div class="text-center mb-10">
            <h2 class="text-3xl font-extrabold text-gray-800">Ma√Ætriser les cours du Pr. Balay√©</h2>
            <p class="text-gray-600">Choisis un module pour commencer √† apprendre</p>
        </div>
        
        <div class="grid md:grid-cols-3 gap-6">
            <div onclick="initQuiz('c1')" class="bg-white p-6 rounded-2xl shadow-md border-b-4 border-blue-500 cursor-pointer card">
                <div class="text-blue-500 text-3xl mb-2">01</div>
                <h3 class="font-bold text-xl mb-2 text-gray-800">Introduction Statistique</h3>
                <p class="text-sm text-gray-500 italic mb-4">Variables, p-value, H0 vs H1.</p>
                <div id="badge-c1" class="text-xs font-bold uppercase py-1 px-2 rounded bg-gray-200 text-gray-600 inline-block">Non tent√©</div>
            </div>

            <div onclick="initQuiz('c2')" class="bg-white p-6 rounded-2xl shadow-md border-b-4 border-green-500 cursor-pointer card">
                <div class="text-green-500 text-3xl mb-2">02</div>
                <h3 class="font-bold text-xl mb-2 text-gray-800">Test Diagnostique</h3>
                <p class="text-sm text-gray-500 italic mb-4">Se/Sp, VPP/VPN, Kappa, ROC.</p>
                <div id="badge-c2" class="text-xs font-bold uppercase py-1 px-2 rounded bg-gray-200 text-gray-600 inline-block">Non tent√©</div>
            </div>

            <div onclick="initQuiz('c3')" class="bg-white p-6 rounded-2xl shadow-md border-b-4 border-purple-500 cursor-pointer card">
                <div class="text-purple-500 text-3xl mb-2">03</div>
                <h3 class="font-bold text-xl mb-2 text-gray-800">√âpid√©miologie</h3>
                <p class="text-sm text-gray-500 italic mb-4">Pr√©valence, Incidence, RR/OR.</p>
                <div id="badge-c3" class="text-xs font-bold uppercase py-1 px-2 rounded bg-gray-200 text-gray-600 inline-block">Non tent√©</div>
            </div>
        </div>
    </section>

    <section id="stats-section" class="container mx-auto p-6 hidden text-center">
        <h2 class="text-3xl font-bold mb-8 text-gray-800">Taux de Compr√©hension</h2>
        <div class="max-w-md mx-auto space-y-6">
            <div class="bg-white p-6 rounded-2xl shadow-md">
                <h4 class="text-gray-600 mb-2">Moyenne Globale</h4>
                <div id="global-percent" class="text-5xl font-black text-indigo-600">0%</div>
            </div>
            <div id="detailed-stats" class="space-y-4">
                </div>
            <button onclick="localStorage.clear(); location.reload();" class="text-red-500 text-sm underline mt-10">R√©initialiser mes scores</button>
        </div>
    </section>

    <section id="quiz-section" class="container mx-auto p-6 hidden">
        <div class="max-w-2xl mx-auto bg-white p-8 rounded-3xl shadow-2xl">
            <div id="quiz-header" class="flex justify-between items-center mb-8">
                <div>
                    <span id="quiz-cat" class="text-xs font-bold text-indigo-500 uppercase tracking-widest"></span>
                    <h3 id="question-count" class="text-gray-400 text-sm">Question 1/15</h3>
                </div>
                <div class="text-right">
                    <span id="score-live" class="font-bold text-green-600 text-xl">0</span>
                </div>
            </div>
            
            <div id="quiz-body">
                <h2 id="question-text" class="text-xl font-bold text-gray-800 mb-8"></h2>
                <div id="options-container" class="space-y-4"></div>
            </div>

            <div id="feedback" class="mt-6 p-4 rounded-xl hidden"></div>

            <button id="next-btn" class="w-full mt-8 bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg hidden">Suivant</button>
        </div>
    </section>

    <script>
        const database = {
            c1: {
                title: "Introduction √† la Statistique",
                questions: [
                    { q: "La statistique fait r√©f√©rence √† :", o: ["La science", "Les r√©sultats chiffr√©s", "La probabilit√© seule"], a: 0 },
                    { q: "Une variable 'Sexe' (H/F) est de type :", o: ["Quantitative discr√®te", "Qualitative nominale", "Qualitative ordinale"], a: 1 },
                    { q: "La moyenne, le mode et la m√©diane sont des indicateurs de :", o: ["Dispersion", "Position", "Corr√©lation"], a: 1 },
                    { q: "Si la p-value est de 0.02, on d√©cide de :", o: ["Conserver H0", "Rejeter H0", "Modifier l'√©chantillon"], a: 1 },
                    { q: "Un test non-significatif (p > 0.05) implique forc√©ment une absence d'effet.", o: ["Vrai", "Faux"], a: 1 },
                    { q: "L'√©cart-type est un indicateur de :", o: ["Position", "Dispersion", "Tendance centrale"], a: 1 },
                    { q: "Le test de corr√©lation r = -0.8 indique une corr√©lation :", o: ["Forte et positive", "Forte et n√©gative", "Faible"], a: 1 },
                    { q: "L'inf√©rence consiste √† extrapoler les r√©sultats de l'√©chantillon √† :", o: ["La population", "Un autre √©chantillon", "L'individu seul"], a: 0 },
                    { q: "Une variable 'Note de 0 √† 20' est une variable :", o: ["Qualitative", "Quantitative"], a: 1 },
                    { q: "L'hypoth√®se nulle H0 postule g√©n√©ralement :", o: ["Une diff√©rence", "L'absence de diff√©rence", "Un risque"], a: 1 },
                    { q: "La variance est le carr√© de :", o: ["La moyenne", "L'√©cart-type", "La m√©diane"], a: 1 },
                    { q: "Un √©chantillon repr√©sentatif est obtenu par :", o: ["Tirage au sort", "B√©n√©volat", "Affinit√©s"], a: 0 },
                    { q: "La statistique descriptive sert √† :", o: ["Extrapoler", "R√©sumer les donn√©es", "Calculer le risque alpha"], a: 1 },
                    { q: "Si on rejette H0 alors qu'elle √©tait vraie, c'est une erreur de :", o: ["Type I (Alpha)", "Type II (Beta)"], a: 0 },
                    { q: "Une corr√©lation n'implique pas forc√©ment une causalit√©.", o: ["Vrai", "Faux"], a: 0 }
                ]
            },
            c2: {
                title: "Test Diagnostique",
                questions: [
                    { q: "Probabilit√© d'√™tre T+ sachant qu'on est Malade (M+) :", o: ["Sp√©cificit√©", "VPP", "Sensibilit√©"], a: 2 },
                    { q: "La Sensibilit√© et la Sp√©cificit√© sont des validit√©s :", o: ["Intrins√®ques", "Extrins√®ques"], a: 0 },
                    { q: "Si la pr√©valence augmente, la VPP :", o: ["Diminue", "Augmente", "Reste fixe"], a: 1 },
                    { q: "Un test tr√®s sensible est utile pour :", o: ["Confirmer", "D√©pister (√©liminer)", "Calculer le Kappa"], a: 1 },
                    { q: "Le coefficient Kappa mesure :", o: ["Le risque", "La concordance", "La moyenne"], a: 1 },
                    { q: "Un Kappa de 0.35 est consid√©r√© comme :", o: ["N√©gligeable", "Faible", "Mod√©r√©"], a: 1 },
                    { q: "L'aire sous la courbe ROC (AUC) id√©ale est proche de :", o: ["0.5", "1", "0"], a: 1 },
                    { q: "La VPP est la probabilit√© d'√™tre Malade sachant que :", o: ["Le test est positif", "Le test est n√©gatif"], a: 0 },
                    { q: "Le Gold Standard est :", o: ["Le nouveau test", "La r√©f√©rence absolue", "Un test de d√©pistage"], a: 1 },
                    { q: "Une courbe ROC montre le lien entre :", o: ["Se et (1-Sp)", "VPP et VPN", "Kappa et p-value"], a: 0 },
                    { q: "Si Sp = 100%, alors il n'y a aucun :", o: ["Faux N√©gatif", "Faux Positif"], a: 1 },
                    { q: "Le calcul du Kappa prend en compte :", o: ["Le hasard", "La pr√©valence seulement", "L'√¢ge"], a: 0 },
                    { q: "Un test avec AUC = 0.5 est :", o: ["Excellent", "Inutile (hasard)", "Tr√®s sp√©cifique"], a: 1 },
                    { q: "La VPN diminue si :", o: ["La pr√©valence augmente", "La pr√©valence diminue"], a: 0 },
                    { q: "Le choix du seuil d'un test modifie :", o: ["La pr√©valence", "Le couple Se/Sp"], a: 1 }
                ]
            },
            c3: {
                title: "√âpid√©miologie",
                questions: [
                    { q: "Nombre de cas √† un instant T :", o: ["Incidence", "Pr√©valence"], a: 1 },
                    { q: "Vitesse d'apparition de nouveaux cas :", o: ["Incidence", "Pr√©valence"], a: 0 },
                    { q: "L'indicateur de risque en √©tude de cohorte est :", o: ["L'Odds Ratio", "Le Risque Relatif"], a: 1 },
                    { q: "Un RR de 2.5 signifie que le risque est augment√© de :", o: ["25%", "150%", "2.5%"], a: 1 },
                    { q: "L'√©tude Cas-T√©moins est adapt√©e aux :", o: ["Maladies rares", "Maladies fr√©quentes", "Vaccins"], a: 0 },
                    { q: "Si l'IC 95% du RR est [0.8 ; 1.2], le r√©sultat est :", o: ["Significatif", "Non significatif"], a: 1 },
                    { q: "L'√©pid√©miologie √©tiologique cherche √† :", o: ["D√©crire", "Trouver des causes", "Soigner"], a: 1 },
                    { q: "L'Odds Ratio (OR) est utilis√© dans les √©tudes :", o: ["Transversales", "Cas-T√©moins", "Cohortes"], a: 1 },
                    { q: "Un facteur protecteur a un RR :", o: ["Sup√©rieur √† 1", "Inf√©rieur √† 1", "√âgal √† 1"], a: 1 },
                    { q: "Le biais de s√©lection impacte :", o: ["La repr√©sentativit√©", "La pr√©cision du calcul", "La p-value uniquement"], a: 0 },
                    { q: "Une √©tude transversale donne une mesure de :", o: ["L'incidence", "La pr√©valence"], a: 1 },
                    { q: "Le RR se calcule par :", o: ["Incidence Exp / Incidence Non-Exp", "Cote Exp / Cote Non-Exp"], a: 0 },
                    { q: "Q17 Balay√© : OR = 1.10 IC95% [1.05 ; 1.18] est :", o: ["Significatif", "Non significatif"], a: 0 },
                    { q: "Le t√©moin dans une √©tude cas-t√©moin doit √™tre :", o: ["Malade", "Non-malade"], a: 1 },
                    { q: "L'√©pid√©miologie descriptive r√©pond √† :", o: ["Pourquoi ?", "Qui, O√π, Quand ?", "Combien √ßa co√ªte ?"], a: 1 }
                ]
            }
        };

        let currentCat = '';
        let currentIdx = 0;
        let score = 0;
        let scoresSaved = JSON.parse(localStorage.getItem('stats_scores')) || { c1: 0, c2: 0, c3: 0 };

        function updateBadges() {
            Object.keys(scoresSaved).forEach(key => {
                const el = document.getElementById('badge-' + key);
                if(scoresSaved[key] > 0) {
                    el.innerText = scoresSaved[key] + "% R√©ussi";
                    el.className = "text-xs font-bold uppercase py-1 px-2 rounded bg-green-100 text-green-700 inline-block";
                }
            });
        }

        function showSection(id) {
            ['home', 'stats-section', 'quiz-section'].forEach(s => document.getElementById(s).classList.add('hidden'));
            if(id === 'stats') {
                document.getElementById('stats-section').classList.remove('hidden');
                renderStats();
            } else if (id === 'quiz') {
                showSection('home');
            } else {
                document.getElementById(id).classList.remove('hidden');
            }
            updateBadges();
        }

        function initQuiz(catId) {
            currentCat = catId;
            currentIdx = 0;
            score = 0;
            showSection('quiz-section');
            document.getElementById('quiz-cat').innerText = database[catId].title;
            loadQuestion();
        }

        function loadQuestion() {
            const data = database[currentCat].questions[currentIdx];
            document.getElementById('question-count').innerText = `Question ${currentIdx + 1}/${database[currentCat].questions.length}`;
            document.getElementById('question-text').innerText = data.q;
            document.getElementById('score-live').innerText = score;
            
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');

            data.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 border-2 border-gray-100 rounded-2xl hover:bg-gray-50 transition font-medium";
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(i);
                container.appendChild(btn);
            });
        }

        function checkAnswer(i) {
            const data = database[currentCat].questions[currentIdx];
            const btns = document.getElementById('options-container').children;
            
            if(i === data.a) {
                score++;
                btns[i].classList.add('correct');
            } else {
                btns[i].classList.add('wrong');
                btns[data.a].classList.add('correct');
            }

            for(let b of btns) b.disabled = true;
            document.getElementById('next-btn').classList.remove('hidden');
        }

        document.getElementById('next-btn').onclick = () => {
            currentIdx++;
            if(currentIdx < database[currentCat].questions.length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        };

        function finishQuiz() {
            const percent = Math.round((score / database[currentCat].questions.length) * 100);
            if(percent > scoresSaved[currentCat]) {
                scoresSaved[currentCat] = percent;
                localStorage.setItem('stats_scores', JSON.stringify(scoresSaved));
            }
            alert(`F√©licitations ! Score : ${percent}%`);
            showSection('stats');
        }

        function renderStats() {
            const avg = Math.round((scoresSaved.c1 + scoresSaved.c2 + scoresSaved.c3) / 3);
            document.getElementById('global-percent').innerText = avg + "%";
            
            const detail = document.getElementById('detailed-stats');
            detail.innerHTML = '';
            
            Object.keys(database).forEach(key => {
                const s = scoresSaved[key];
                detail.innerHTML += `
                    <div class="bg-gray-50 p-4 rounded-xl flex justify-between items-center">
                        <span class="font-bold text-gray-700">${database[key].title}</span>
                        <span class="font-black ${s > 70 ? 'text-green-500' : 'text-orange-500'}">${s}%</span>
                    </div>
                `;
            });
        }

        updateBadges();
    </script>
</body>
</html>
